<div class="org_profile">
    <div class="org_profile_title">
        <h2>Профиль организации</h2>
    </div>
    <div class="org_profile_info">
        <div class="org_profile_info_first">
            <div class="org_profile_img">
                <img src="/upload/{{organization.profile_image}}" alt="Изображение пользователя">
            </div>
            <div class="org_profile_inn">
                ИНН: <p class="org_profile_txt">{{organization.inn}}</p>
                <input type="text" class="edit-inn hidden">
            </div>
            <div class="org_profile_kpp">
                КПП: <p class="org_profile_txt">{{organization.kpp}}</p>
                <input type="text" class="edit-kpp hidden">
            </div>
            <div class="org_profile_ogrn">
                ОГРН: <p class="org_profile_txt">{{organization.ogrn}}</p>
                <input type="text" class="edit-ogrn hidden">
            </div>
        </div>
        <div class="org_profile_info_second">
            <div class="org_profile_fullname">
                Полное имя: <p class="org_profile_txt">{{organization.organization_full_name}}</p>
                <input type="text" class="edit-fullname hidden">
            </div>
            <div class="org_profile_shortname">
                Краткое имя: <p class="org_profile_txt">{{organization.organization_short_name}}</p>
                <input type="text" class="edit-shortname hidden">
            </div>
            <div class="org_profile_discription">
                Описание: <p class="org_profile_txt">{{organization.add_info}}</p>
                <input type="text" class="edit-dscrpt hidden">
            </div>

        </div>
        <div class="org_profile_info_third">
            <div class="org_profile_secondname">
                Фамилия: <p class="org_profile_txt">{{organization.responsible_person_surname}}</p>
                <input type="text" class="edit-surname hidden">
            </div>
            <div class="org_profile_name">
                Имя: <p class="org_profile_txt">{{organization.responsible_person_name}}</p>
                <input type="text" class="edit-name hidden">
            </div>
            <div class="org_profile_thirdname">
                Отчество: <p class="org_profile_txt">{{organization.responsible_person_patronymic}}</p>
                <input type="text" class="edit-patronymic hidden">
            </div>
            <div class="org_profile_email">
                Email: <p class="org_profile_txt">{{organization.responsible_person_email}}</p>
                <input type="text" class="edit-email hidden">
            </div>
            <div class="org_profile_phone">
                Номер телефона: <p class="org_profile_txt">{{organization.responsible_person_phone_number}}</p>
                <input type="text" class="edit-phone hidden">
            </div>
            <div class="org_profile_info_button">
                <button onclick="toggleEdit()">Изменить данные</button>
            </div>
        </div>

    </div>
    <div class="org_profile_mywork">
        <div class="org_profile_services">
            <div class="org_profile_services_title">
                <h2>Мои услуги</h2>
            </div>
            <div class="gonvo">
                <div class="org_profile_services_main">
                    <div class="org_prof_srvc_col">
                        <div class="org_profile_service">
                            <div class="org_profile_service_name">
                                <p class="org_profile_txt">Шиномонтаж</p>
                            </div>
                            <div class="org_profile_service_price">
                                <p class="org_profile_txt">200 руб</p>
                            </div>
                        </div>
                        <div class="org_profile_service">
                            <div class="org_profile_service_name">
                                <p class="org_profile_txt">Шиномонтаж</p>
                            </div>
                            <div class="org_profile_service_price">
                                <p class="org_profile_txt">200 руб</p>
                            </div>
                        </div>
                    </div>

                    <div class="org_profile_service_button_add">
                        <button>
                            <p>Добавить услугу</p>
                        </button>
                    </div>

                </div>
            </div>
        </div>
        <div class="org_profile_requests">
            <div class="org_profile_requests_title">
                <h2>Мои заявки</h2>
            </div>
            <div class="org_profile_requests_main">
                <div class="org_profile_request">
                    <div class="namerequest">
                        <p class="org_profile_txt">Шиномонтаж</p>
                    </div>
                    <div class="daterequest">
                        <p class="org_profile_txt">04.05.2024</p>
                    </div>
                    <div class="phonerequest">
                        <p class="org_profile_txt">+79378422909</p>
                    </div>
                    <div class="buttonrequest"><button>Подтвердить</button></div>
                </div>
                <div class="org_profile_request">
                    <div class="namerequest">
                        <p class="org_profile_txt">Шиномонтаж</p>
                    </div>
                    <div class="daterequest">
                        <p class="org_profile_txt">04.05.2024</p>
                    </div>
                    <div class="phonerequest">
                        <p class="org_profile_txt">+79378422909</p>
                    </div>
                    <div class="buttonrequest"><button>Подтвердить</button></div>
                </div>
            </div>
        </div>
    </div>

</div>
<script>
    function saveData() {
        // Создаем объект FormData для сбора данных из полей
        var formData = new FormData();

        // Добавляем данные из каждого поля в объект FormData
        fields.forEach(function (field) {
            var inputElement = document.querySelector(field.inputSelector);
            formData.append(field.inputSelector.replace('.edit-', ''), inputElement.value);
            console.log(formData)
        });

        // Отправляем AJAX запрос
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/saveDataOrg', true);
        xhr.onload = function () {
            if (xhr.status === 200) {
                alert('Данные успешно сохранены!');
            } else {
                alert('Произошла ошибка при сохранении данных.');
            }
        };
        xhr.onerror = function () {
            alert('Произошла ошибка при отправке запроса.');
        };
        xhr.send(formData);
    }
    var fields = [
        { textSelector: '.org_profile_secondname .org_profile_txt', inputSelector: '.edit-surname' },
        { textSelector: '.org_profile_name .org_profile_txt', inputSelector: '.edit-name' },
        { textSelector: '.org_profile_thirdname .org_profile_txt', inputSelector: '.edit-patronymic' },
        { textSelector: '.org_profile_email .org_profile_txt', inputSelector: '.edit-email' },
        { textSelector: '.org_profile_phone .org_profile_txt', inputSelector: '.edit-phone' },
        { textSelector: '.org_profile_fullname .org_profile_txt', inputSelector: '.edit-fullname' },
        { textSelector: '.org_profile_shortname .org_profile_txt', inputSelector: '.edit-shortname' },
        { textSelector: '.org_profile_discription .org_profile_txt', inputSelector: '.edit-dscrpt' },
        { textSelector: '.org_profile_inn .org_profile_txt', inputSelector: '.edit-inn' },
        { textSelector: '.org_profile_kpp .org_profile_txt', inputSelector: '.edit-kpp' },
        { textSelector: '.org_profile_ogrn .org_profile_txt', inputSelector: '.edit-ogrn' }
    ];

    var saveButton = document.querySelector('.org_profile_info_button button');

    function toggleEdit() {
        fields.forEach(function (field) {
            var textElement = document.querySelector(field.textSelector);
            var inputElement = document.querySelector(field.inputSelector);

            if (inputElement.classList.contains('hidden')) {
                textElement.classList.add('hidden');
                inputElement.classList.remove('hidden');
                inputElement.value = textElement.textContent.trim();
            } else {
                textElement.classList.remove('hidden');
                inputElement.classList.add('hidden');
                textElement.textContent = inputElement.value.trim();
            }
        });

        if (saveButton.textContent === 'Изменить данные') {
            saveButton.textContent = 'Сохранить';
        } else {
            saveButton.textContent = 'Изменить данные';
            saveData();
        }
    }
</script>