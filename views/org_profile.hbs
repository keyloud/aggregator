<div class="org_profile">
    <div class="info">
        <div>
            <img src="/upload/{{organization.profile_image}}">
        </div>
        <div class="about">
            <div class="inn">
                <p class="txt">{{organization.inn}}</p>
                <input type="text" class="edit-inn hidden">
            </div>
            <div class="kpp">
                <p class="txt">{{organization.kpp}}</p>
                <input type="text" class="edit-kpp hidden">
            </div>
            <div class="ogrn">
                <p class="txt">{{organization.ogrn}}</p>
                <input type="text" class="edit-ogrn hidden">
            </div>
        </div>
        <div class="description">
            <div class="fullname">
                <p class="txt">{{organization.organization_full_name}}</p>
                <input type="text" class="edit-fullname hidden">
            </div>
            <div class="shortname">
                <p class="txt">{{organization.organization_short_name}}</p>
                <input type="text" class="edit-shortname hidden">
            </div>
            <div class="dscrpt">
                <p class="txt">{{organization.add_info}}</p>
                <input type="text" class="edit-dscrpt hidden">
            </div>
        </div>
        <div class="bio">
            <div class="org_prof_surname">
                <p class="txt">{{organization.responsible_person_surname}}</p>
                <input type="text" class="edit-surname hidden">
            </div>
            <div class="org_prof_name">
                <p class="txt">{{organization.responsible_person_name}}</p>
                <input type="text" class="edit-name hidden">
            </div>
            <div class="org_prof_patronymic">
                <p class="txt">{{organization.responsible_person_patronymic}}</p>
                <input type="text" class="edit-patronymic hidden">
            </div>

            <div class="org_prof_email">
                <p class="txt">{{organization.responsible_person_email}}</p>
                <input type="text" class="edit-email hidden">
            </div>
            <div class="phone">
                <p class="txt">{{organization.responsible_person_phone_number}}</p>
                <input type="text" class="edit-phone hidden">
            </div>
        </div>

    </div>
    <div class="btn">
        <div class="btnSAVE">
            <button onclick="toggleEdit()">Изменить данные</button>
        </div>
    </div>
    <div class="services">
        <div class="title">
            <h3>Мои услуги</h3>
        </div>
        <div class="main">
            {{#each service_detail}}
            <div class="myservices">
                <div class="srvc">
                    <p class="txt">{{this.service_detail_name}}</p>
                </div>
            </div>
            <div class="prices">
                <div class="price">
                    <p class="txt">{{this.service_detail_cost}}</p>
                </div>
            </div>
            {{/each}}
        </div>
    </div>
    <div class="request">
        <div class="title">
            <h3>Мои заявки</h3>
        </div>
        <div class="main">
            <div class="namerequest">
                <div class="nmrqst">
                    <p class="txt">Мойка днища</p>
                </div>

            </div>
            <div class="date">
                <div class="dtrqst">
                    <p class="txt">Дата</p>
                </div>
            </div>
            <div class="number">
                <div class="numbuser">
                    <p class="txt">Телефон пользователя</p>
                </div>
            </div>
            <div class="button_agree">
                <div class="btnagree">
                    <button>Подтвердить</button>
                </div>
            </div>
        </div>
    </div>
<script src="usrRedact.js"></script>
</div>
<script>
    function saveData() {
        // Создаем объект FormData для сбора данных из полей
        var formData = new FormData();

        // Добавляем данные из каждого поля в объект FormData
        fields.forEach(function (field) {
            var inputElement = document.querySelector(field.inputSelector);
            formData.append(field.inputSelector.replace('.edit-', ''), inputElement.value);
            console.log(formData)
        });

        // Отправляем AJAX запрос
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/saveDataOrg', true);
        xhr.onload = function () {
            if (xhr.status === 200) {
                alert('Данные успешно сохранены!');
            } else {
                alert('Произошла ошибка при сохранении данных.');
            }
        };
        xhr.onerror = function () {
            alert('Произошла ошибка при отправке запроса.');
        };
        xhr.send(formData);
    }
    var fields = [
        { textSelector: '.org_prof_surname .txt', inputSelector: '.edit-surname' },
        { textSelector: '.org_prof_name .txt', inputSelector: '.edit-name' },
        { textSelector: '.org_prof_patronymic .txt', inputSelector: '.edit-patronymic' },
        { textSelector: '.org_prof_email .txt', inputSelector: '.edit-email' },
        { textSelector: '.phone .txt', inputSelector: '.edit-phone' },
        { textSelector: '.fullname .txt', inputSelector: '.edit-fullname' },
        { textSelector: '.shortname .txt', inputSelector: '.edit-shortname' },
        { textSelector: '.dscrpt .txt', inputSelector: '.edit-dscrpt' },
        { textSelector: '.inn .txt', inputSelector: '.edit-inn' },
        { textSelector: '.kpp .txt', inputSelector: '.edit-kpp' },
        { textSelector: '.ogrn .txt', inputSelector: '.edit-ogrn' }
    ];

    var saveButton = document.querySelector('.btnSAVE button');

    function toggleEdit() {
        fields.forEach(function (field) {
            var textElement = document.querySelector(field.textSelector);
            var inputElement = document.querySelector(field.inputSelector);

            if (inputElement.classList.contains('hidden')) {
                textElement.classList.add('hidden');
                inputElement.classList.remove('hidden');
                inputElement.value = textElement.textContent.trim();
            } else {
                textElement.classList.remove('hidden');
                inputElement.classList.add('hidden');
                textElement.textContent = inputElement.value.trim();
            }
        });

        if (saveButton.textContent === 'Изменить данные') {
            saveButton.textContent = 'Сохранить';
        } else {
            saveButton.textContent = 'Изменить данные';
            saveData();
        }
    }
</script>